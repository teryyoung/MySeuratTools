% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/auto_qc_nfeatures_and_ncounts.R
\name{smart_qc_cutoff}
\alias{smart_qc_cutoff}
\title{自动识别分布形态并计算过滤阈值 (修复版)}
\usage{
smart_qc_cutoff(
  values,
  filter_side = c("low", "high"),
  knee_selection = c("closer", "further"),
  adjust = 2,
  assumption = "gaussian",
  min_peak_ratio = 1e-04,
  valley_strictness = 0.99,
  show_plot = TRUE,
  title = ""
)
}
\arguments{
\item{values}{数值向量 (nFeature 或 nCount)。}

\item{filter_side}{字符串。"low" (默认，切除左尾) 或 "high" (切除右尾)。}

\item{knee_selection}{字符串。"closer" (默认，选离主峰最近的拐点) 或 "further" (选离主峰最远的拐点)。}

\item{adjust}{平滑度 (默认 2.0)。}

\item{assumption}{"gaussian" 或 "poisson" (用于 counts 的 sqrt 变换)。}

\item{min_peak_ratio}{双峰检测时，副峰的最小高度比例 (默认 1e-4)。}

\item{valley_strictness}{双峰检测时，谷底深度的严格程度 (默认 0.99，即谷底低于某一峰值的0.99倍则判定为谷底)。}
}
\description{
这个函数用于根据 nFeature 或 nCount 或其他数值的分布（双峰或单峰长尾），
自动选择合适的算法（谷底法或拐点法）来计算过滤阈值。
双峰模式下，使用谷底作为阈值。
单峰模式下，采用“二阶导数局部峰值法”，寻找分布函数的拐角。
}
